# Session Log - 2026-02-23 12:00:00

## What Was Wrong / What Was Requested

Implement T8 macOS-only research tools per a 14-step plan: shared training data types, TrainingDataStore actor, ValidationRunner, TrainingManager actor, AppDependencies macOS additions, TrainingViewModel, ValidationViewModel, TrainingDataViewModel, three Style structs, TrainingView, ValidationView, TrainingDataView, wire into ContentView, and Xcode project registration. All new code gated with `#if os(macOS)` and following MVVM-S pattern.

## How I Fixed It / What I Did

1. Created TrainingModels.swift (LoRAConfig, TrainingClause, ValidationResult, LoRAAdapterMetadata, TrainingProgress); TrainingDataStore actor; ValidationRunner; TrainingManager actor (stub training loop yielding epoch progress and .complete with metadata).
2. Added macOS-only properties and init to AppDependencies (trainingManager, validationRunner, trainingDataStore).
3. Created TrainingViewModel, ValidationViewModel, TrainingDataViewModel with all specified properties and methods.
4. Created TrainingViewStyle, ValidationViewStyle, TrainingDataViewStyle.
5. Created TrainingView (model card, config grid, Start/Cancel, warning banner, progress chart with TrainingLossChartDescriptor, success banner), ValidationView (Run All, summary banner, four test cards), TrainingDataView (HSplitView: table + List editor with SwiftUI.Section, filter pickers, Export JSONL, unsaved alert).
6. Replaced ContentUnavailableView placeholders in ContentView with the three views and added @State view models.
7. Registered new files: added to PBXFileSystemSynchronizedBuildFileExceptionSet membershipExceptions and added PBXFileReference + PBXBuildFile entries and Sources build phase references so the target actually compiles them.
8. Fixes: TrainingProgress.complete now carries metadata; TrainingViewModel startTraining/cancelTraining use Task and await for actor calls; TrainingDataViewModel.exportJSONL uses UniformTypeIdentifiers; TrainingView Chart uses direct foregroundStyle (no chartForegroundStyleScale); TrainingDataView uses List with SwiftUI.Section and no listStyle (grouped/insetGrouped unavailable on macOS).

## Challenges Encountered

1. **Xcode file membership**: The target uses both a synchronized root group and an explicit PBXSourcesBuildPhase file list. Adding only to membershipExceptions did not include the new files in the compile; PBXFileReference, PBXBuildFile, and Sources phase entries were required.
2. **Actor isolation**: TrainingViewModel called TrainingManager.train() and cancel() from sync context; fixed by awaiting inside Task and calling cancel() in a Task.
3. **Chart API**: chartForegroundStyleScale(range:) required a type conforming to ScaleRange; switched to applying foregroundStyle per LineMark.
4. **Form / List on macOS**: Form { } led to "trailing closure passed to FormStyleConfiguration"; replaced with List. Section("Clause") caused "argument type 'String' does not conform to Decoder" (name clash); used SwiftUI.Section. .listStyle(.insetGrouped) and .grouped are unavailable on macOS; removed listStyle.
5. **NSSavePanel**: allowedContentTypes uses UTType.plainText from UniformTypeIdentifiers; added import.

## Next Ideas (6 Ideas)

1. Add unit tests for TrainingDataStore load/save and ValidationRunner.
2. Add sample historical_clauses.jsonl in Data/ for first-run experience.
3. Persist TrainingViewModel.config to UserDefaults.
4. Add keyboard shortcuts for TrainingDataView (Save, Delete, Add).
5. VoiceOver chart descriptor for validation summary.
6. TrainingManager: real LoRA loop with MLXLLM when API is available; until then stub with simulated epochs.
